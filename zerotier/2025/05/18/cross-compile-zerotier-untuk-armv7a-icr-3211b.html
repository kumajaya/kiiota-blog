<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cross Compile ZeroTier untuk armv7a Advantech ICR-3211B | Kiiota Blog</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Cross Compile ZeroTier untuk armv7a Advantech ICR-3211B" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Pendahuluan ZeroTier adalah solusi jaringan global yang menggabungkan fitur VPN, SD-WAN, dan konektivitas IoT dalam satu platform. Dengan ZeroTier, pengguna dapat menghubungkan perangkat mereka ke jaringan pribadi yang aman tanpa perlu konfigurasi kompleks atau perangkat keras tambahan. Beberapa fitur utama ZeroTier: Koneksi Peer-to-Peer: Perangkat dapat berkomunikasi langsung tanpa harus melewati server pusat. Keamanan Tinggi: Data dienkripsi end-to-end, memastikan privasi dan keama" />
<meta property="og:description" content="Pendahuluan ZeroTier adalah solusi jaringan global yang menggabungkan fitur VPN, SD-WAN, dan konektivitas IoT dalam satu platform. Dengan ZeroTier, pengguna dapat menghubungkan perangkat mereka ke jaringan pribadi yang aman tanpa perlu konfigurasi kompleks atau perangkat keras tambahan. Beberapa fitur utama ZeroTier: Koneksi Peer-to-Peer: Perangkat dapat berkomunikasi langsung tanpa harus melewati server pusat. Keamanan Tinggi: Data dienkripsi end-to-end, memastikan privasi dan keama" />
<link rel="canonical" href="https://kumajaya.github.io/kiiota-blog/zerotier/2025/05/18/cross-compile-zerotier-untuk-armv7a-icr-3211b.html" />
<meta property="og:url" content="https://kumajaya.github.io/kiiota-blog/zerotier/2025/05/18/cross-compile-zerotier-untuk-armv7a-icr-3211b.html" />
<meta property="og:site_name" content="Kiiota Blog" />
<meta property="og:image" content="https://images.unsplash.com/photo-1603985529862-9e12198c9a60?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wxMTc3M3wwfDF8c2VhcmNofDF8fHZwbnxlbnwwfHx8fDE3NDczODg4NjN8MA&ixlib=rb-4.1.0&q=80&w=2000" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-18T06:34:52+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://images.unsplash.com/photo-1603985529862-9e12198c9a60?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wxMTc3M3wwfDF8c2VhcmNofDF8fHZwbnxlbnwwfHx8fDE3NDczODg4NjN8MA&ixlib=rb-4.1.0&q=80&w=2000" />
<meta property="twitter:title" content="Cross Compile ZeroTier untuk armv7a Advantech ICR-3211B" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-05-18T06:34:52+00:00","datePublished":"2025-05-18T06:34:52+00:00","description":"Pendahuluan ZeroTier adalah solusi jaringan global yang menggabungkan fitur VPN, SD-WAN, dan konektivitas IoT dalam satu platform. Dengan ZeroTier, pengguna dapat menghubungkan perangkat mereka ke jaringan pribadi yang aman tanpa perlu konfigurasi kompleks atau perangkat keras tambahan. Beberapa fitur utama ZeroTier: Koneksi Peer-to-Peer: Perangkat dapat berkomunikasi langsung tanpa harus melewati server pusat. Keamanan Tinggi: Data dienkripsi end-to-end, memastikan privasi dan keama","headline":"Cross Compile ZeroTier untuk armv7a Advantech ICR-3211B","image":"https://images.unsplash.com/photo-1603985529862-9e12198c9a60?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wxMTc3M3wwfDF8c2VhcmNofDF8fHZwbnxlbnwwfHx8fDE3NDczODg4NjN8MA&ixlib=rb-4.1.0&q=80&w=2000","mainEntityOfPage":{"@type":"WebPage","@id":"https://kumajaya.github.io/kiiota-blog/zerotier/2025/05/18/cross-compile-zerotier-untuk-armv7a-icr-3211b.html"},"url":"https://kumajaya.github.io/kiiota-blog/zerotier/2025/05/18/cross-compile-zerotier-untuk-armv7a-icr-3211b.html"}</script>
<!-- End Jekyll SEO tag -->
<link id="main-stylesheet" rel="stylesheet" href="/kiiota-blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://kumajaya.github.io/kiiota-blog/feed.xml" title="Kiiota Blog" /><!-- Dark Mode Detection -->
<script>
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.classList.add('dark-mode');
  }
</script>

<!-- PrismJS Syntax Highlighting Theme + Plugins -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/themes/prism-coy.min.css" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.css" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.css" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/command-line/prism-command-line.min.css" crossorigin="anonymous">

<!-- KaTeX (Math Typesetting Engine) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" crossorigin="anonymous">

<!-- Font Awesome Icon Suite -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

<!-- Dukungan favicon -->
<link rel="icon" type="image/png" sizes="16x16" href="/kiiota-blog/assets/media/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/kiiota-blog/assets/media/favicon-32x32.png">
<link rel="shortcut icon" href="/kiiota-blog/assets/media/favicon.ico">

<style>
/* Reduce site title line-height and bottom margin */
.site-header .wrapper {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 60px;
  padding: 0 1rem;
}
.site-title {
  margin: 0;
  font-size: 1.5rem;
  line-height: 1.2;
  font-weight: bold;
  text-decoration: none;
  color: inherit;
}
.site-title:hover,
.site-title:focus {
  text-decoration: none;
  color: inherit;
}

/* Post header left-align */
.post-header {
  text-align: left !important;
  padding-left: 0;
  border-bottom: 1px solid var(--border-color, #e0e0e0);
}
.post-category a {
  text-decoration: none;
}
.post-category a:hover,
.post-category a:focus {
  text-decoration: none;
  color: inherit;
}
.post-title {
  text-align: left !important;
  margin-left: 0;
}

/* Hide Ghost-specific elements */
.kg-card, .kg-file-card, .kg-audio-card, .kg-audio-card *, .scroll-button, .scroll-button svg, .gh-sidebar {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  pointer-events: none !important;
}

/* Native Audio Player Styling */
.native-audio-wrapper {
  margin: 1.5rem 0;
}

.native-audio-wrapper audio {
  width: 100%;
}

.audio-title {
  font-size: 1rem;
  font-weight: 600;
  color: #333;
  margin-bottom: 0.5rem;
  line-height: 1.4;
}

/* Mermaid Diagram Styling */
.mermaid {
  font-family: 'Segoe UI', sans-serif;
  background: rgba(255,255,255,0.9) !important;
  margin: 2.5rem auto;
  padding: 1.8rem;
  overflow: visible;
  text-align: center;
  opacity: 0;
  transition: opacity 0.5s ease-in;
}
.mermaid.is-ready { opacity: 1; }

/* Node & Label Styling */
.mermaid .node rect, .mermaid .node circle, .mermaid .node polygon, .mermaid .actor {
  fill: #ffffff;
  stroke: #3b82f6;
  stroke-width: 2.2px;
  rx: 8px; ry: 8px;
  filter: drop-shadow(0 2px 3px rgba(59,130,246,0.12)) drop-shadow(0 1px 1px rgba(59,130,246,0.1));
  transition: all 0.25s ease;
}
.mermaid .node text, .mermaid .label, .mermaid .label text {
  color: #1f2937;
  font-weight: 600;
  letter-spacing: 0.25px;
  line-height: 1.5;
}

/* Arrow & Edge Styling */
.mermaid .marker, .mermaid .arrowheadPath, .mermaid .arrowhead path { fill: #3b82f6 !important; stroke: none !important; }
.mermaid .edgePath path, .mermaid .path { stroke: #3b82f6; stroke-width: 2.6px; stroke-linecap: round; }
.mermaid path, .mermaid line { stroke-width: 1.5px !important; }

/* Diagram Title */
.mermaid .title, .mermaid .title text { font-weight: 600; color: #1e40af; }

/* Dark Mode Overrides */
.dark-mode .mermaid {
  background: rgba(17,24,39,0.85) !important;
  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.2), 0 10px 15px -3px rgba(0,0,0,0.25);
}
.dark-mode .mermaid .node rect, .dark-mode .mermaid .node circle, .dark-mode .mermaid .node polygon, .dark-mode .mermaid .actor {
  fill: #111827;
  stroke: #60a5fa;
  filter: drop-shadow(0 2px 3px rgba(96,165,250,0.2)) drop-shadow(0 1px 1px rgba(96,165,250,0.15));
}
.dark-mode .mermaid .node text, .dark-mode .mermaid .label, .dark-mode .mermaid .label text { color: #f3f4f6; }
.dark-mode .mermaid .edgePath path, .dark-mode .mermaid .path { stroke: #60a5fa; }
.dark-mode .mermaid .title, .dark-mode .mermaid .title text { color: #93c5fd; }

/* Responsive Mermaid Adjustments */
@media (max-width: 768px) {
  .mermaid { padding: 1.2rem; border-radius: 10px; }
  .mermaid .label, .mermaid .node text, .mermaid .label text { font-size: 1.15rem !important; }
}

/* Table Styling */
table td, table th { border: 1px solid #e0e0e0; }
table tr:nth-child(even) { background-color: #f9f9f9; }
table td:first-child, table th:first-child { padding-left: 0.75em !important; }
table th { background-color: #222149; color: #fff !important; font-weight: bold; }
</style>
</head>
<body><header class="site-header">

  <div class="wrapper">
    <a class="site-title" rel="author" href="/kiiota-blog/">Kiiota Blog</a>
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon"></span>
        </label>

        <div class="nav-items">
  <a class="nav-item" href="/kiiota-blog/pages/contact.html">Kontak</a>
  <a class="nav-item" href="/kiiota-blog/pages/about.html">Tentang situs ini</a>
  <a class="nav-item" href="/kiiota-blog/pages/privacy.html">Privasi</a>
</div>

      </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
    

    
    <div class="post-category">
      
      <a href="/kiiota-blog/tags/zerotier">
        Zerotier
      </a>
    </div>
    

    <h1 class="post-title p-name" itemprop="name headline">Cross Compile ZeroTier untuk armv7a Advantech ICR-3211B</h1>
    <div class="post-meta">
      <time class="dt-published" datetime="2025-05-18T06:34:52+00:00" itemprop="datePublished">
        May 18, 2025
      </time>
      <div class="force-inline post-authors">
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Ketut Putu Kumajaya</span>
          </span>
        
      </div>
      
      <div class="force-inline post-authors">
        <span class="reading-time">6 min read</span>
      </div>
      
    </div>
  </header>

  
  <p class="post-excerpt" itemprop="description">
    Pendahuluan


ZeroTier adalah solusi jaringan global yang menggabungkan fitur VPN, SD-WAN, dan konektivitas IoT dalam satu platform. Dengan ZeroTier, pengguna dapat menghubungkan perangkat mereka ke jaringan pribadi yang aman tanpa perlu konfigurasi kompleks atau perangkat keras tambahan.


Beberapa fitur utama ZeroTier:


 * Koneksi Peer-to-Peer: Perangkat dapat berkomunikasi langsung tanpa harus melewati server pusat.
 * Keamanan Tinggi: Data dienkripsi end-to-end, memastikan privasi dan keama

  </p>
  

  
  <figure class="post-feature-image">
    <img src="https://images.unsplash.com/photo-1603985529862-9e12198c9a60?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wxMTc3M3wwfDF8c2VhcmNofDF8fHZwbnxlbnwwfHx8fDE3NDczODg4NjN8MA&ixlib=rb-4.1.0&q=80&w=2000" alt="Cross Compile ZeroTier untuk armv7a Advantech ICR-3211B" loading="lazy" class="post-feature-img">
    
    <figcaption class="post-feature-caption">
      <p>Photo by <a href="https://unsplash.com/@privecstasy?utm_source=ghost&amp;utm_medium=referral&amp;utm_campaign=api-credit">Privecstasy</a> / <a href="https://unsplash.com/?utm_source=ghost&amp;utm_medium=referral&amp;utm_campaign=api-credit">Unsplash</a></p>

    </figcaption>
    
  </figure>
  

  <div class="post-content e-content" itemprop="articleBody">
    
<!--kg-card-begin: markdown-->
<h2 id="pendahuluan"><strong>Pendahuluan</strong></h2>
<p><strong>ZeroTier</strong> adalah solusi jaringan global yang menggabungkan fitur VPN, SD-WAN, dan konektivitas IoT dalam satu platform. Dengan ZeroTier, pengguna dapat menghubungkan perangkat mereka ke jaringan pribadi yang aman tanpa perlu konfigurasi kompleks atau perangkat keras tambahan.</p>
<p><strong>Beberapa fitur utama ZeroTier:</strong></p>
<ul>
<li><strong>Koneksi Peer-to-Peer</strong>: Perangkat dapat berkomunikasi langsung tanpa harus melewati server pusat.</li>
<li><strong>Keamanan Tinggi</strong>: Data dienkripsi end-to-end, memastikan privasi dan keamanan komunikasi.</li>
<li><strong>Kemudahan Penggunaan</strong>: Instalasi ringan dan dapat digunakan di berbagai sistem operasi serta perangkat.</li>
<li><strong>Manajemen Jaringan</strong>: Memungkinkan pengguna untuk mengontrol dan mengelola jaringan mereka melalui antarmuka web yang intuitif.</li>
</ul>
<blockquote>
<p>&quot;Jika Anda ingin mencoba atau mempelajari lebih lanjut, kunjungi <a href="https://www.zerotier.com/?ref=blog.kiiota.com">situs resmi ZeroTier</a>.&quot;</p>
</blockquote>
<p>Artikel ini menjelaskan <strong>cara melakukan cross-compile ZeroTier client untuk perangkat ICR-3211B dari Advantech</strong>, khususnya berbasis <strong>ARMv7a 32-bit</strong>. Metode ini berguna untuk perangkat seperti router atau sistem berbasis embedded Linux lainnya.</p>
<hr />

<h2 id="persiapan-cross-compile"><strong>Persiapan Cross-Compile</strong></h2>
<ul>
<li><strong>Host Linux atau WSL (Windows Subsystem for Linux)</strong>: Menggunakan distribusi Ubuntu, Debian, atau sejenisnya.</li>
<li><strong>Toolchain khusus ICR-3211B</strong>: Dapat diunduh dari <a href="https://bitbucket.org/bbsmartworx/toolchains/src/master/?ref=blog.kiiota.com">Advantech Toolchains Repository</a>, lebih spesifik <a href="https://bitbucket.org/bbsmartworx/toolchains/raw/ca59bfd00eacd7c86e3d9d9560c01dade4198503/deb/gcc-icr-v3-armv7-linux-gnueabi-7.4.0-3.x86_64.deb?ref=blog.kiiota.com">V3 routers (ARM Cortex-A8)</a> untuk target keluarga ICR-3200.</li>
<li><strong>Koneksi internet</strong> untuk mengunduh dependensi.</li>
</ul>
<h3 id="1-instalasi-toolchain-cross-compiler"><strong>1. Instalasi Toolchain Cross-Compiler</strong></h3>
<pre><code class="language-bash">sudo apt-get install git make pkg-config build-essential  
sudo dpkg -i gcc-icr-v3-armv7-linux-gnueabi-7.4.0-3.x86_64.deb  
</code></pre>
<p>Toolchain akan terinstal di <strong><code>/opt/toolchain/gcc-icr-v3-armv7-linux-gnueabi/</code></strong>.</p>
<h3 id="2-clone-kode-sumber-zerotier"><strong>2. Clone Kode Sumber ZeroTier</strong></h3>
<pre><code class="language-bash">git clone https://github.com/zerotier/ZeroTierOne.git --depth=1  
cd ZeroTierOne  
</code></pre>
<p>Opsi <strong><code>--depth=1</code></strong> memastikan hanya commit terbaru yang diunduh untuk menghemat bandwidth.</p>
<h3 id="3-patch-untuk-perbaikan-deteksi-arsitektur-dan-optimasi"><strong>3. Patch untuk Perbaikan Deteksi Arsitektur dan Optimasi</strong></h3>
<p>Patch berikut disiapkan untuk memperbaiki deteksi arsitektur saat kompilasi dan optimasi ARM Cortex-A8 ICR-3211B. ARMv7a tidak memiliki dukungan native penuh untuk operasi atomic di semua prosesor, sehingga beberapa operasi seperti <strong><code>std::atomic</code></strong> pada C++ atau <strong><code>__atomic_</code></strong> pada GCC memerlukan pustaka tambahan untuk bekerja dengan benar. Untuk menghindari error saat linking, <strong><code>override LDFLAGS+=-latomic</code></strong> ditambahkan. Simpan patch berikut sebagai <strong><code>make-linux-Fix-architecture-detection.patch</code></strong>:</p>
<pre><code class="language-patch">From 0a82874f6d1170205fa50400b3904bcab1e7da56 Mon Sep 17 00:00:00 2001
From: Ketut Kumajaya &lt;ketut.kumajaya@gmail.com&gt;
Date: Sat, 17 May 2025 21:19:46 +0700
Subject: [PATCH] make-linux: Fix architecture detection

---
 make-linux.mk | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/make-linux.mk b/make-linux.mk
index efc1bad..e47397b 100644
--- a/make-linux.mk
+++ b/make-linux.mk
@@ -334,7 +334,12 @@ endif

 # ARM32 hell -- use conservative CFLAGS
 ifeq ($(ZT_ARCHITECTURE),3)
-       ifeq ($(shell if [ -e /usr/bin/dpkg ]; then dpkg --print-architecture; fi),armel)
+       ifeq ($(shell $(CC) -dM -E - &lt;/dev/null | grep -q __ARM_ARCH_7A__ &amp;&amp; echo 1),1)
+               override CFLAGS+=-march=armv7-a -mtune=cortex-a8 -mfloat-abi=softfp -mfpu=vfpv3 -O2
+               override CXXFLAGS+=-march=armv7-a -mtune=cortex-a8 -mfloat-abi=softfp -mfpu=vfpv3 -O2
+               override LDFLAGS+=-latomic
+               ZT_USE_ARM32_NEON_ASM_CRYPTO=0
+       else ifeq ($(shell $(CC) -dM -E - &lt;/dev/null | grep -q __ARMEL__ &amp;&amp; echo 1),1)
                override CFLAGS+=-march=armv5t -mfloat-abi=soft -msoft-float -mno-unaligned-access -marm
                override CXXFLAGS+=-march=armv5t -mfloat-abi=soft -msoft-float -mno-unaligned-access -marm
                ZT_USE_ARM32_NEON_ASM_CRYPTO=0
--
2.43.0
</code></pre>
<p>kemudian terapkan ke kode sumber ZeroTier:</p>
<pre><code class="language-bash">git apply make-linux-Fix-architecture-detection.patch
</code></pre>
<h3 id="4-konfigurasi-cross-compile"><strong>4. Konfigurasi Cross Compile</strong></h3>
<p>Konfigurasi toolchain cross compile sebagai berikut:</p>
<pre><code class="language-bash">export CC=/opt/toolchain/gcc-icr-v3-armv7-linux-gnueabi/bin/armv7-linux-gnueabi-gcc
export CXX=/opt/toolchain/gcc-icr-v3-armv7-linux-gnueabi/bin/armv7-linux-gnueabi-g++
export LD=/opt/toolchain/gcc-icr-v3-armv7-linux-gnueabi/bin/armv7-linux-gnueabi-ld
</code></pre>
<h3 id="5-kompilasi-zerotier"><strong>5. Kompilasi ZeroTier</strong></h3>
<p>Kompilasi ZeroTier dengan sejumlah thread prosesor yang tersedia agar prosesnya berlangsung cepat. Bila perlu, lakukan <strong><code>strip</code></strong> setelah kompilasi agar ukuran binary ZeroTier menjadi sangat kecil:</p>
<pre><code class="language-bash">make -j$(nproc)
/opt/toolchain/gcc-icr-v3-armv7-linux-gnueabi/bin/armv7-linux-gnueabi-strip --strip-all zerotier-one
</code></pre>
<h3 id="6-menyalin-binary-ke-target"><strong>6. Menyalin Binary ke Target</strong></h3>
<p>Setelah kompilasi selesai, binary ZeroTier yang dihasilkan dapat ditemukan di direktori <em><code>ZeroTierOne/</code></em>. Anda bisa menyalinnya ke perangkat menggunakan SCP atau metode lain:</p>
<pre><code class="language-bash">scp zerotier-one root@ip-target:/usr/sbin/
</code></pre>
<h3 id="7-verifikasi"><strong>7. Verifikasi</strong></h3>
<p>Login ke perangkat ARMv7a dan jalankan binary untuk memastikan berhasil:</p>
<pre><code class="language-bash">ssh root@ip-target
cd /usr/sbin
ln -sf zerotier-one zerotier-idtool
ln -sf zerotier-one zerotier-cli
zerotier-one -h
</code></pre>
<hr />

<h2 id="menjalankan-zerotier-di-icr-3211b"><strong>Menjalankan ZeroTier di ICR-3211B</strong></h2>
<p>Pada <strong>sistem minimalis seperti ICR-3211B</strong>, layanan <strong>systemd</strong> tidak tersedia, sehingga tidak bisa menggunakan <strong><code>systemctl</code></strong>. Sebagai solusi, kita akan menggunakan <strong>skrip init</strong> untuk mengelola ZeroTier secara langsung dan memastikan layanan tetap berjalan setelah reboot atau jika mengalami crash.</p>
<h3 id="1-menambahkan-skrip-startup-dan-monitoring-ke-sistem"><strong>1. Menambahkan Skrip Startup dan Monitoring ke Sistem</strong></h3>
<p>Simpan skrip berikut sebagai <strong><code>/etc/rc.d/init.d/zerotier-one</code></strong>:</p>
<pre><code class="language-bash">#!/bin/sh

DAEMON=&quot;zerotier-one&quot;
DATADIR=&quot;/var/data/zerotier-one&quot;
PIDFILE=&quot;$DATADIR/$DAEMON.pid&quot;
WALL_CHAIN=&quot;srv_$DAEMON&quot;
LOCAL_PORT=9993
EXTRA_OPTS=&quot;-d -p$LOCAL_PORT $DATADIR&quot;

. /etc/rc.d/init.d/functions

start() {
    if [ -f &quot;$PIDFILE&quot; ] &amp;&amp; ps | grep -v grep | grep &quot;$(cat $PIDFILE)&quot; &gt; /dev/null 2&gt;&amp;1; then
        echo &quot;$DAEMON is already running.&quot;
    else
        echo &quot;Starting $DAEMON...&quot;
        mkdir -p &quot;$DATADIR&quot; /var/lib
        ln -sf &quot;$DATADIR&quot; /var/lib/zerotier-one
        add_chain $WALL_CHAIN
        add_rule $WALL_CHAIN udp $LOCAL_PORT
        add_chain6 $WALL_CHAIN
        add_rule6 $WALL_CHAIN udp $LOCAL_PORT
        logger -t &quot;$DAEMON&quot; &quot;$DAEMON service start&quot;
        nohup &quot;$DAEMON&quot; $EXTRA_OPTS &amp;&gt; /dev/null &amp;
        echo $! &gt; &quot;$PIDFILE&quot;
        echo &quot;Started.&quot;
    fi
}

stop() {
    if [ -f &quot;$PIDFILE&quot; ] &amp;&amp; ps | grep -v grep | grep &quot;$(cat $PIDFILE)&quot; &gt; /dev/null 2&gt;&amp;1; then
        echo &quot;Stopping $DAEMON...&quot;
        kill -9 &quot;$(cat $PIDFILE)&quot; &amp;&amp; rm -f &quot;$PIDFILE&quot;
        sleep 2
        del_chain $WALL_CHAIN
        del_chain6 $WALL_CHAIN
        logger -t &quot;$DAEMON&quot; &quot;$DAEMON service stop&quot;
        echo &quot;Stopped.&quot;
    else
        echo &quot;$DAEMON is not running.&quot;
    fi
}

status() {
    echo -n &quot;$DAEMON is &quot;
    if [ -f &quot;$PIDFILE&quot; ] &amp;&amp; ps | grep -v grep | grep &quot;$(cat $PIDFILE)&quot; &gt; /dev/null 2&gt;&amp;1; then
        echo &quot;running (PID: $(cat $PIDFILE))&quot;
    else
        echo &quot;not running.&quot;
    fi
}

restart() {
    echo &quot;Restarting $DAEMON...&quot;
    stop
    sleep 3
    start
}

case &quot;$1&quot; in
    start) start ;;
    stop) stop ;;
    restart) restart ;;
    status) status ;;
    *) echo &quot;Usage: $0 {start|stop|restart|status}&quot; ;;
esac

exit 0
</code></pre>
<p>Simpan skrip berikut sebagai <strong><code>/usr/sbin/zerotier-watchdog</code></strong> untuk memastikan layanan selalu tetap berjalan:</p>
<pre><code class="language-bash">#!/bin/sh

DAEMON=&quot;zerotier-one&quot;
PIDFILE=&quot;/var/data/zerotier-one/$DAEMON.pid&quot;
CHECK_INTERVAL=15  # Check every 15 seconds

while true; do
    if [ -f &quot;$PIDFILE&quot; ] &amp;&amp; ps | grep -v grep | grep &quot;$(cat $PIDFILE)&quot; &gt; /dev/null 2&gt;&amp;1; then
        echo &quot;$DAEMON is running.&quot;
    else
        logger -t &quot;$DAEMON&quot; &quot;$DAEMON stopped. Restarting...&quot;
        service $DAEMON start
    fi
    sleep &quot;$CHECK_INTERVAL&quot;
done
</code></pre>
<h3 id="2-mengaktifkan-skrip-startup"><strong>2. Mengaktifkan Skrip Startup</strong></h3>
<p>Setelah menyimpan skrip di <strong><code>/etc/rc.d/init.d/zerotier</code></strong>, jalankan perintah berikut untuk <strong>mengaktifkan startup otomatis</strong>:</p>
<pre><code class="language-bash">chmod +x /etc/rc.d/init.d/zerotier-one
cd /etc/rc.d/rc.start
ln -sf /etc/rc.d/init.d/zerotier-one rc.99.zerotier-one
</code></pre>
<p>Di halaman web ICR-3211B, ubah <strong>startup script</strong> menjadi:</p>
<pre><code class="language-bash">#!/bin/sh
#
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here.
chmod 777 /dev/net/tun

nohup zerotier-watchdog &amp;&gt; /dev/null &amp;
</code></pre>
<h3 id="3-verifikasi-debugging"><strong>3. Verifikasi &amp; Debugging</strong></h3>
<ul>
<li><strong>Pastikan layanan berjalan:</strong></li>
</ul>
<pre><code class="language-bash">service zerotier-one start
service zerotier-one status
ip a
</code></pre>
<ul>
<li><strong>Periksa log jika ada masalah:</strong><br />
Setelah reboot, periksa kembali log dan status jaringan melalui antarmuka web ICR-3211B untuk memastikan ZeroTier berjalan normal.</li>
</ul>
<hr />

<h2 id="bergabung-ke-jaringan-zerotier"><strong>Bergabung ke Jaringan ZeroTier</strong></h2>
<p>Setelah ZeroTier berhasil berjalan di ICR-3211B, langkah berikutnya adalah <strong>bergabung ke jaringan ZeroTier</strong> agar perangkat dapat berkomunikasi dengan sistem lain.</p>
<h3 id="1-dapatkan-network-id"><strong>1. Dapatkan Network ID</strong></h3>
<p>Sebelum menghubungkan perangkat, pastikan Anda memiliki <strong>Network ID</strong> dari jaringan yang telah dibuat di <strong>ZeroTier Central</strong>.</p>
<ul>
<li>Login ke <strong>ZeroTier Central</strong>: <a href="https://my.zerotier.com/?ref=blog.kiiota.com">https://my.zerotier.com</a></li>
<li>Buat atau pilih jaringan yang ingin digunakan.</li>
<li>Catat <strong>Network ID</strong> (biasanya berupa string angka, misalnya <code>abcdef1234567890</code>).</li>
</ul>
<p>Anda bisa meminta <strong>Network ID</strong> ke administrator jaringan jika menggunakan jaringan ZeroTier private self hosted.</p>
<h3 id="2-bergabung-ke-jaringan-dari-icr-3211b"><strong>2. Bergabung ke Jaringan dari ICR-3211B</strong></h3>
<p>Gunakan perintah berikut di perangkat ICR-3211B:</p>
<pre><code class="language-bash">zerotier-cli join &lt;NETWORK_ID&gt;
</code></pre>
<p>Contoh:</p>
<pre><code class="language-bash">zerotier-cli join abcdef1234567890 
</code></pre>
<h3 id="3-verifikasi-koneksi"><strong>3. Verifikasi Koneksi</strong></h3>
<p>Setelah bergabung ke jaringan, pastikan perangkat telah berhasil terkoneksi:</p>
<pre><code class="language-bash">zerotier-cli info 
</code></pre>
<p>Jika berhasil, output akan menunjukkan <strong>status jaringan aktif</strong>, seperti:</p>
<pre><code class="language-bash">200 info &lt;ztaddr&gt; &lt;ver&gt; ONLINE
</code></pre>
<p>Jika jaringan memerlukan <strong>persetujuan manual</strong>, masuk ke ZeroTier Central, lalu <strong>izinkan perangkat bergabung</strong> ke jaringan atau minta persetujuan ke administrator jaringan private yang digunakan.</p>
<h3 id="4-cek-ip-address-di-zerotier"><strong>4. Cek IP Address di ZeroTier</strong></h3>
<p>Gunakan perintah berikut untuk melihat IP yang diberikan oleh jaringan ZeroTier:</p>
<pre><code class="language-bash">zerotier-cli listnetworks
</code></pre>
<p>Hasilnya akan menunjukkan <strong>IP yang diberikan</strong>, misalnya:</p>
<pre><code class="language-bash">200 listnetworks abcdef1234567890 &lt;name&gt; &lt;mac&gt; OK PRIVATE &lt;dev&gt; 10.10.10.15/24
</code></pre>
<h3 id="5-uji-koneksi-antar-perangkat"><strong>5. Uji Koneksi Antar Perangkat</strong></h3>
<p>Gunakan <strong>ping</strong> untuk menguji konektivitas antar perangkat yang terhubung ke ZeroTier:</p>
<pre><code class="language-bash">ping &lt;IP_DEVICE_LAIN&gt;
</code></pre>
<p>Misalnya jika perangkat lain memiliki IP <strong>10.10.10.20</strong>:</p>
<pre><code class="language-bash">ping 10.10.10.20
</code></pre>
<p>Jika ping berhasil, berarti koneksi melalui <strong>ZeroTier</strong> sudah aktif!</p>
<p>Sekarang, <strong>ICR-3211B telah terhubung ke jaringan ZeroTier</strong> dan siap digunakan untuk komunikasi dengan perangkat lain.</p>
<hr />

<h2 id="penutup"><strong>Penutup</strong></h2>
<p>Dengan langkah-langkah yang telah dijelaskan, ZeroTier-One kini dapat berjalan optimal di ICR-3211B, meskipun tanpa dukungan systemd. Cross-compiling, penerapan patch arsitektur, serta skrip startup dan monitoring layanan memastikan bahwa sistem tetap stabil dan terhubung tanpa perlu intervensi manual.</p>
<p>Keunggulan dari pendekatan ini:</p>
<ul>
<li><strong>Portabilitas:</strong> Dapat digunakan pada perangkat ARMv7a lainnya dengan sedikit modifikasi.</li>
<li><strong>Keamanan:</strong> Firewall diaktifkan untuk melindungi komunikasi jaringan.</li>
<li><strong>Reliabilitas:</strong> Layanan otomatis restart jika ada kegagalan proses.</li>
</ul>
<p>Jika Anda ingin melakukan penyesuaian lebih lanjut—misalnya optimasi sumber daya atau penerapan kebijakan keamanan tambahan—artikel ini bisa menjadi dasar yang kuat. ZeroTier memungkinkan konektivitas fleksibel dan aman, sehingga cocok untuk berbagai implementasi di sistem embedded Linux lainnya.</p>
<p><strong>Tetap eksplorasi dan selamat mencoba!</strong></p>
<!--kg-card-end: markdown-->

  </div>

  <a class="u-url" href="/kiiota-blog/zerotier/2025/05/18/cross-compile-zerotier-untuk-armv7a-icr-3211b.html" hidden></a>
  <meta itemprop="mainEntityOfPage" content="https://kumajaya.github.io/kiiota-blog/zerotier/2025/05/18/cross-compile-zerotier-untuk-armv7a-icr-3211b.html">
</article>

<style>
.post-category {
  text-transform: uppercase;
  font-size: 0.875rem;
  margin-bottom: 0.25rem;
}

.post-feature-image {
  margin-top: 1rem;
}

.post-feature-img {
  width: 100%;
  height: auto;
  border-radius: 6px;
}

.post-feature-caption {
  font-size: 0.875rem;
  color: #6b7280;
  margin-top: 0.25rem;
}
</style>

      </div>
    </main><link id="fa-stylesheet" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.0.0/css/all.min.css">

<footer class="site-footer h-card">
  <data class="u-url" value="/kiiota-blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <ul class="contact-list">
          <li class="p-name">Ketut Kumajaya</li>
          <li><a class="u-email" href="mailto:ketut.kumajaya@gmail.com">ketut.kumajaya@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Kiiota Blog adalah ruang catatan teknis dan refleksi humanis di dunia otomasi industri. Berisi dokumentasi eksperimen, troubleshooting, dan filosofi kerja yang lahir dari lapangan. Repositori ini menyimpan konten dalam bentuk statis, memungkinkan backup otomatis, serta publikasi via static site generator (Jekyll, Hugo, Eleventy) dan GitHub Pages.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
    <a rel="me" href="https://github.com/kumajaya/kiiota-blog" target="_blank" title="Repositori Kiiota Blog di GitHub">
      <span class="grey fa-brands fa-github fa-lg"></span>
    </a>
  </li><li>
    <a rel="me" href="https://x.com/ketutkumajaya" target="_blank" title="Ketut Kumajaya at X (formerly Twitter)">
      <span class="grey fa-brands fa-x-twitter fa-lg"></span>
    </a>
  </li>
  <li>
    <a href="https://kumajaya.github.io/kiiota-blog/feed.xml" target="_blank" title="Subscribe to syndication feed">
      <svg class="svg-icon grey" viewbox="0 0 16 16">
        <path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194
          11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.99 2.194-2.2 2.194C.98 16 0 15.017 0
          13.806c0-1.21.983-2.195 2.194-2.195zM10.606
          16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"
        />
      </svg>
    </a>
  </li>
</ul>
</div>

  </div>

</footer>
<!-- PrismJS: Core syntax highlighting engine and plugins -->
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/prism.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/autoloader/prism-autoloader.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/toolbar/prism-toolbar.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/command-line/prism-command-line.min.js"></script>

<script defer>
  window.addEventListener('DOMContentLoaded', () => {
    // Configure Prism Autoloader
    if (Prism.plugins.autoloader) {
      Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.30.0/components/';
    }

    // Add line numbers to all code blocks
    document.querySelectorAll('pre[class*=language-]').forEach(node => {
      node.classList.add('line-numbers');
    });

    // Trigger syntax highlighting
    Prism.highlightAll();
  });
</script>

<!-- KaTeX: Load math typesetting engine + auto-render -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>

<script defer>
  document.addEventListener("DOMContentLoaded", () => {
    renderMathInElement(document.body, {
      delimiters: [
        {left: "$$", right: "$$", display: true},   // Block
        {left: "$", right: "$", display: false},     // Inline
        {left: "\\(", right: "\\)", display: false},
        {left: "\\[", right: "\\]", display: true}
      ]
    });
  });
</script>

<!-- Mermaid.js: Initialize diagrams -->
<script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.9.0/dist/mermaid.min.js" crossorigin="anonymous"></script>
<script defer>
  window.addEventListener('DOMContentLoaded', () => {
    if (!window.mermaid) return;

    mermaid.initialize({
      startOnLoad: false,        // Manual rendering
      theme: 'base',
      fontFamily: 'Segoe UI, sans-serif',
      securityLevel: 'loose',
      themeVariables: {
        primaryColor: '#f0f7ff',
        primaryBorderColor: '#3b82f6'
      }
    });

    // Lazy-load observer for Mermaid diagrams
    const observer = new IntersectionObserver((entries, obs) => {
      entries.forEach(async entry => {
        if (entry.isIntersecting) {
          const el = entry.target;
          if (!el.id) el.id = `mermaid-diagram-${Math.random().toString(36).substr(2, 9)}`;
          await mermaid.run({ querySelector: `#${el.id}` });
          el.classList.add('is-ready');
          obs.unobserve(el);
        }
      });
    }, { rootMargin: '100px' });

    document.querySelectorAll('.mermaid').forEach(el => observer.observe(el));
  });
</script>

<!-- Audio Card Enhancement: Replace Ghost audio cards with native players -->
<script defer>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".kg-audio-card").forEach(function (card) {
      const audio = card.querySelector("audio");
      const title = card.querySelector(".kg-audio-title")?.textContent || "";
      const src = audio?.getAttribute("src");

      if (!src) return;

      // Buat elemen player
      const nativePlayer = document.createElement("audio");
      nativePlayer.setAttribute("controls", "");
      nativePlayer.setAttribute("preload", "metadata");

      const source = document.createElement("source");
      source.setAttribute("src", src);
      source.setAttribute("type", "audio/mpeg");
      nativePlayer.appendChild(source);

      // Tambahkan fallback sebagai node teks
      nativePlayer.appendChild(document.createTextNode(
        "Browser Anda tidak mendukung pemutar audio atau file tidak tersedia."
      ));

      // Bungkus semua dalam wrapper
      const wrapper = document.createElement("div");
      wrapper.className = "native-audio-wrapper";

      // Tambahkan caption di atas player
      if (title) {
        const caption = document.createElement("div");
        caption.className = "audio-title";
        caption.textContent = title;
        wrapper.appendChild(caption);
      }

      wrapper.appendChild(nativePlayer);

      // Tambahkan metadata untuk audit/logging
      wrapper.setAttribute("data-audio-source", src);
      wrapper.setAttribute("data-audio-title", title);

      // Ganti elemen Ghost dengan versi native
      card.replaceWith(wrapper);
    });
  });
</script>
</body>

</html>
